<!DOCTYPE html>
<head>
	<meta charset="utf-8">
	<title>Speed Dating</title>

    <script src="library/d3/d3.min.js" charset="utf-8"></script>
    <script src="library/jquery/jquery-2.1.1.min.js" charset="utf-8"></script>
    <script src="library/bootstrap/js/bootstrap.min.js" charset="utf-8"></script>
    <script src="library/queue/queue.min.js" charset="utf-8"></script>

	<style>
	</style>
</head>
<body>

<script>
	// call this function after both files are loaded -- error should be "null" if no error
	var dataLoaded = function (error, datingdata) {

	    if (!error) {

			data = d3.nest()
				.key(function(d) { return d.wave;})
				.rollup(function(d) { 
					return d;
				})
				.entries(datingdata);

			var datalength = data.length;

			for (var i =0; i < datalength; i++) {
				var data_row = d3.nest()
					.key(function(d) { return d.iid;})
					.rollup(function(d) {
						return d;
					})
					.entries(data[i]["values"]);
				//console.log(data[i])
				data[i] = data_row;
			}

		console.log(data)
	    }
	}

	var startHere = function(){

	    //TODO: load data here and call "dataLoaded" afterwards
	    queue() // loads all the data files
	        .defer(d3.csv, '/data/SpeedDating.csv') // metadata
	        .await(dataLoaded); // function that uses files


	}

	startHere();

</script>
</body>
</html>